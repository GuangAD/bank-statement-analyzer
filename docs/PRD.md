# 银行流水智能分析工具 - 产品需求文档 (PRD)

## 文档信息

| 项目     | 内容                 |
| -------- | -------------------- |
| 产品名称 | 银行流水智能分析工具 |
| 版本     | v1.0.0               |
| 创建日期 | 2026-01-29           |
| 文档状态 | 已发布               |

---

## 1. 产品概述

### 1.1 产品简介

银行流水智能分析工具是一款**纯前端**的个人财务分析工具，用户可以上传银行流水 PDF 文件，系统自动解析交易数据，进行智能分类，并通过丰富的图表可视化展示财务状况。

### 1.2 产品定位

- **目标用户**：个人用户、家庭财务管理者、自由职业者
- **使用场景**：整理个人收支、分析消费习惯、财务规划、报税准备
- **核心价值**：隐私安全、操作简便、分析直观

### 1.3 核心差异化

| 特性     | 本产品             | 传统记账软件     |
| -------- | ------------------ | ---------------- |
| 数据安全 | 纯前端，数据不上传 | 需上传云端       |
| 数据录入 | PDF自动解析        | 手动记账         |
| 使用门槛 | 无需注册登录       | 需注册账号       |
| 隐私保护 | 浏览器关闭即销毁   | 长期存储在服务器 |

---

## 2. 用户画像

### 2.1 主要用户群体

#### 用户A：个人理财新手

- **年龄**：22-30岁
- **特征**：刚开始关注个人财务，不习惯手动记账
- **痛点**：不清楚钱花在哪里，想分析消费习惯
- **需求**：简单上传文件即可看到分析结果

#### 用户B：家庭财务管理者

- **年龄**：30-45岁
- **特征**：管理家庭开支，需要定期整理财务
- **痛点**：多个银行账户，整理繁琐
- **需求**：合并多份流水，统一分析

#### 用户C：隐私敏感型用户

- **年龄**：不限
- **特征**：对数据隐私高度敏感
- **痛点**：不信任云端存储财务数据
- **需求**：数据完全本地处理，不上传

---

## 3. 功能需求

### 3.1 功能架构图

```
┌─────────────────────────────────────────────────────────────┐
│                      银行流水智能分析工具                     │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │  文件上传    │  │  数据解析    │  │     数据存储         │  │
│  │  - 拖拽上传  │  │  - PDF解析   │  │  - Pinia Store      │  │
│  │  - 点击选择  │  │  - 银行识别   │  │  - 内存暂存          │  │
│  │  - 多文件    │  │  - 智能分类   │  │                     │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │  收支仪表盘  │  │  月度看板    │  │     图表分析         │  │
│  │  - 总收入    │  │  - 月度汇总  │  │  - 趋势图            │  │
│  │  - 总支出    │  │  - 盈亏指示  │  │  - 饼图              │  │
│  │  - 结余     │  │  - 快速筛选  │  │  - 柱状图            │  │
│  │  - 笔数统计  │  │             │  │  - 热力图            │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │  筛选面板    │  │  交易列表    │  │     数据导出         │  │
│  │  - 时间范围  │  │  - 明细展示  │  │  - Excel             │  │
│  │  - 类型筛选  │  │  - 详情展开  │  │  - CSV               │  │
│  │  - 分类筛选  │  │  - 添加备注  │  │                     │  │
│  │  - 关键词    │  │  - 修改分类  │  │                     │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 功能清单

#### P0 核心功能（必须实现）

| 功能模块 | 功能点           | 优先级 | 状态 |
| -------- | ---------------- | ------ | ---- |
| 文件上传 | PDF文件拖拽上传  | P0     | ✅   |
| 文件上传 | 多文件批量上传   | P0     | ✅   |
| 文件上传 | 删除已上传文件   | P0     | ✅   |
| PDF解析  | 民生银行流水解析 | P0     | ✅   |
| PDF解析  | 交易信息提取     | P0     | ✅   |
| 智能分类 | 22种预设分类     | P0     | ✅   |
| 智能分类 | 关键词自动匹配   | P0     | ✅   |
| 数据展示 | 收支仪表盘       | P0     | ✅   |
| 数据展示 | 交易明细列表     | P0     | ✅   |
| 数据导出 | Excel导出        | P0     | ✅   |
| 数据导出 | CSV导出          | P0     | ✅   |

#### P1 重要功能（应该实现）

| 功能模块 | 功能点         | 优先级 | 状态 |
| -------- | -------------- | ------ | ---- |
| 月度看板 | 月度收支汇总   | P1     | ✅   |
| 月度看板 | 点击快速筛选   | P1     | ✅   |
| 图表分析 | 收支趋势图     | P1     | ✅   |
| 图表分析 | 分类饼图       | P1     | ✅   |
| 图表分析 | 月度对比柱状图 | P1     | ✅   |
| 图表分析 | 日历热力图     | P1     | ✅   |
| 筛选功能 | 时间范围筛选   | P1     | ✅   |
| 筛选功能 | 收支类型筛选   | P1     | ✅   |
| 筛选功能 | 分类多选筛选   | P1     | ✅   |
| 筛选功能 | 关键词搜索     | P1     | ✅   |
| 交易详情 | 展开查看详情   | P1     | ✅   |
| 交易详情 | 用户添加备注   | P1     | ✅   |
| 交易详情 | 手动修改分类   | P1     | ✅   |
| 主题     | 亮色/暗色切换  | P1     | ✅   |

#### P2 锦上添花（可以实现）

| 功能模块   | 功能点           | 优先级 | 状态 |
| ---------- | ---------------- | ------ | ---- |
| 银行支持   | 工商银行解析器   | P2     | 🔄   |
| 银行支持   | 招商银行解析器   | P2     | 🔄   |
| 银行支持   | 建设银行解析器   | P2     | 🔄   |
| 数据持久化 | LocalStorage存储 | P2     | 🔄   |
| 分析报告   | 生成PDF报告      | P2     | 🔄   |
| 预算管理   | 设置分类预算     | P2     | 🔄   |

---

## 4. 功能详细设计

### 4.1 文件上传模块

#### 4.1.1 功能描述

用户可通过拖拽或点击方式上传银行流水 PDF 文件，支持多文件同时上传。

#### 4.1.2 交互流程

```
用户操作              系统响应
  │                     │
  ├─ 拖拽文件到上传区 ──→ 高亮显示上传区
  │                     │
  ├─ 释放文件 ─────────→ 开始解析，显示进度
  │                     │
  ├─ 解析完成 ─────────→ 显示解析结果
  │                     │
  └─ 点击删除 ─────────→ 确认对话框 → 移除文件及数据
```

#### 4.1.3 状态展示

| 状态     | 图标 | 说明           |
| -------- | ---- | -------------- |
| 待上传   | 📤   | 默认空状态     |
| 解析中   | ⏳   | 显示进度百分比 |
| 解析成功 | ✅   | 显示交易笔数   |
| 解析失败 | ❌   | 显示错误信息   |

### 4.2 智能分类模块

#### 4.2.1 分类列表

| ID            | 名称       | 图标 | 颜色    | 关键词示例                 |
| ------------- | ---------- | ---- | ------- | -------------------------- |
| salary        | 工资薪酬   | 💰   | #4CAF50 | 工资、代发、薪资、奖金     |
| transfer      | 银行转账   | 🏦   | #2196F3 | 转账、汇款、转入、转出     |
| wechat_pay    | 微信支付   | 💬   | #07C160 | 微信、财付通、微信转账     |
| alipay        | 支付宝     | 🔷   | #1677FF | 支付宝、花呗、借呗、余额宝 |
| credit_card   | 信用卡还款 | 💳   | #9C27B0 | 信用卡、还款、账单         |
| investment    | 投资理财   | 📈   | #00BCD4 | 基金、理财、股票、收益     |
| housing       | 房租房贷   | 🏠   | #795548 | 房租、房贷、按揭、物业     |
| transport     | 交通出行   | 🚗   | #607D8B | 加油、打车、地铁、高铁     |
| dining        | 餐饮美食   | 🍔   | #FF9800 | 美团、饿了么、餐饮、外卖   |
| online_shop   | 网购消费   | 🛒   | #E91E63 | 淘宝、京东、拼多多、天猫   |
| offline_shop  | 线下购物   | 🏪   | #8BC34A | 超市、商场、便利店         |
| telecom       | 通讯缴费   | 📱   | #03A9F4 | 移动、联通、电信、话费     |
| utilities     | 水电燃气   | 💡   | #FFC107 | 水费、电费、燃气、暖气     |
| medical       | 医疗健康   | 🏥   | #F44336 | 医院、药店、体检、挂号     |
| education     | 教育培训   | 🎓   | #3F51B5 | 学费、培训、书籍、课程     |
| entertainment | 娱乐休闲   | 🎮   | #673AB7 | 电影、游戏、旅游、健身     |
| clothing      | 服装配饰   | 👔   | #009688 | 服装、鞋帽、优衣库         |
| beauty        | 美容护理   | 💄   | #E91E63 | 美容、美发、化妆品         |
| pets          | 宠物相关   | 🐕   | #8D6E63 | 宠物、猫粮、狗粮           |
| social        | 人情往来   | 🎁   | #F06292 | 红包、礼金、随礼           |
| service       | 生活服务   | 🔧   | #78909C | 快递、家政、维修           |
| other         | 其他       | ❓   | #9E9E9E | 默认分类                   |

#### 4.2.2 分类匹配算法

```javascript
function categorize(description, counterparty) {
  const text = `${description} ${counterparty}`.toLowerCase();

  for (const category of CATEGORIES) {
    for (const keyword of category.keywords) {
      if (text.includes(keyword)) {
        return category;
      }
    }
  }

  return CATEGORY_OTHER;
}
```

### 4.3 月度看板模块

#### 4.3.1 功能描述

以卡片形式展示每月的收支汇总，直观显示盈亏状态，点击可快速筛选该月交易。

#### 4.3.2 卡片信息

| 字段     | 说明                       |
| -------- | -------------------------- |
| 月份     | 如 "2025年5月"             |
| 收入     | 该月总收入金额             |
| 支出     | 该月总支出金额             |
| 结余     | 收入 - 支出                |
| 状态标签 | 盈余（绿色）/ 超支（红色） |
| 比例条   | 收支比例可视化             |

#### 4.3.3 交互设计

- 鼠标悬停：卡片上浮 + 边框高亮
- 点击卡片：自动设置筛选日期范围为该月
- 选中状态：蓝色边框 + 背景色变化
- 清除筛选：显示"清除月份筛选"按钮

### 4.4 图表分析模块

#### 4.4.1 趋势折线图

- **数据维度**：按日/周/月切换
- **展示内容**：收入曲线、支出曲线
- **交互**：鼠标悬停显示具体数值

#### 4.4.2 分类饼图

- **数据维度**：收入分类/支出分类切换
- **展示内容**：各分类占比
- **图例**：分类名称 + 金额 + 百分比

#### 4.4.3 月度对比柱状图

- **展示内容**：每月收入柱、支出柱、结余折线
- **交互**：鼠标悬停显示详情

#### 4.4.4 日历热力图

- **数据维度**：按年份切换
- **展示内容**：每日交易金额密度
- **色阶**：金额越大颜色越深

---

## 5. 非功能需求

### 5.1 性能要求

| 指标     | 要求               |
| -------- | ------------------ |
| 首屏加载 | < 2秒              |
| PDF解析  | < 5秒（100页以内） |
| 图表渲染 | < 1秒              |
| 筛选响应 | < 200ms            |

### 5.2 兼容性要求

| 浏览器  | 最低版本 |
| ------- | -------- |
| Chrome  | 90+      |
| Firefox | 88+      |
| Safari  | 14+      |
| Edge    | 90+      |

### 5.3 安全要求

- 所有数据处理必须在浏览器端完成
- 禁止向任何外部服务器发送用户数据
- 页面关闭后数据必须完全销毁

---

## 6. 技术方案

### 6.1 技术选型

| 层级     | 技术       | 说明            |
| -------- | ---------- | --------------- |
| 前端框架 | Vue 3      | Composition API |
| 构建工具 | Vite       | 快速热更新      |
| 状态管理 | Pinia      | 轻量级状态管理  |
| 图表库   | ECharts 5  | 丰富的图表类型  |
| PDF解析  | pdfjs-dist | Mozilla PDF.js  |
| 日期处理 | Day.js     | 轻量日期库      |
| 导出     | xlsx       | Excel文件生成   |

### 6.2 数据流

```
PDF文件 → pdf.js解析 → 银行解析器 → 智能分类 → Pinia Store → Vue组件渲染
                                                    ↓
                                              xlsx/csv导出
```

---

## 7. 项目里程碑

| 阶段   | 内容                       | 状态 |
| ------ | -------------------------- | ---- |
| Phase1 | 核心功能开发               | ✅   |
| Phase2 | 图表可视化                 | ✅   |
| Phase3 | 月度看板 + 交易详情        | ✅   |
| Phase4 | 微信/支付宝分类 + 解析优化 | ✅   |
| Phase5 | 更多银行支持               | 🔄   |
| Phase6 | 数据持久化                 | 🔄   |

---

## 8. 附录

### 8.1 术语定义

| 术语     | 定义                                           |
| -------- | ---------------------------------------------- |
| 摘要     | 银行流水中的交易描述，如"支付宝-快捷支付-还款" |
| 对方户名 | 交易对手方名称或商户名                         |
| 支付渠道 | 交易通道，如支付宝、财付通、网银在线等         |
| 凭证号   | 银行生成的交易唯一编号                         |

### 8.2 参考资料

- [Vue 3 官方文档](https://vuejs.org/)
- [ECharts 官方文档](https://echarts.apache.org/)
- [PDF.js 文档](https://mozilla.github.io/pdf.js/)
